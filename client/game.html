<template name="game">
	<div class="container">
		<div class="col s12" id="error"></div>
		<div class="forumbg row">
			{{#if currentUser}}
			
			{{#if gameInfoExists }}
				{{#if paused}}
					<button class="red darken-4 white-text" id="pause" value="PAUSED">PAUSED</button>
				{{else}}
					<button class="green darken-4 white-text" id="pause" value="pause">pause</button>
				{{/if}}
				{{#if inCombat}}
					{{startCombatLoop}}
					<div class="col s12 center deep-orange darken-4 red-text text-lighten-3">IN COMBAT</div>
					
					<div class="col s12 center">
						<label for="combatlog" class="orange-text">Combat Log</label>
						<textarea id="combatlog" class="validate left" rows="8" style="height:8em;resize: vertical;"></textarea>
					</div>
					{{fillCombatMessages}}
					{{#each combatInfoUnits}}
						<div class="col s12 m6 l3 card {{cardColor this}} darken-4" id="{this}">
							<div class="card-content white-text">
								<span class="card-title">{{cardName this}}</span>
								<br /> {{cardHeader this}} <br /> <br />
								
								{{#if isPlayer this}}
									<div class="small">{{unitVitalHp this}}</div>
									<div class="progress green lighten-3">
										<div class="determinate green" id="{{this}}hp" style="width:{{unitPercentHp this}}%"></div>
									</div>
									<div class="small">{{unitVitalMp this}}</div>
									<div class="progress blue lighten-3">
										<div class="determinate blue" id="{{this}}mp" style="width:{{unitPercentMp this}}%"></div>
									</div>
									<div class="small">{{unitVitalSp this}}</div>
									<div class="progress red lighten-3">
										<div class="determinate red" id="{{this}}sp" style="width:{{unitPercentSp this}}%"></div>
									</div>
									<div class="small">{{unitVitalExp this}}</div>
									<div class="progress purple lighten-3">
										<div class="determinate purple" id="{{this}}exp" style="width:{{unitPercentExp this}}%"></div>
									</div>
									
								{{else}}
									<div class="small">{{unitVitalHp this}}</div>
									<div class="progress green lighten-3">
										<div class="determinate green" id="{{this}}hp" style="width:{{unitPercentHp this}}%"></div>
									</div>
									<div class="progress blue lighten-3">
										<div class="determinate blue" id="{{this}}mp" style="width:{{unitPercentMp this}}%"></div>
									</div>
									<div class="progress red lighten-3">
										<div class="determinate red" id="{{this}}sp" style="width:{{unitPercentSp this}}%"></div>
									</div>
								{{/if}}
								
								<div class="progress yellow lighten-3">
									<div class="determinate orange darken-3" id="{{this}}timer" style="width:{{unitPercentTimer this}}%"></div>
								</div>
							</div>
							<div class="card-action">
								Abilities <br /> [Attack]
							</div>
							
						</div>
						
					{{/each}}
				{{else}}
					<div class="col s12 center green darken-4 green-text text-lighten-3">In Town</div>
					{{> regiondropdown }}
					{{#each gameInfoUnits}}
						{{{menuCard this}}}
					{{/each}}
				{{/if}}
				<div class="row">
				</div>
			{{else}}
			<div class="card blue-grey darken-4">
				<div class="card-content white-text">
					<span class="card-title">Start New Game</span>
					
					<p>Welcome to AFKgame! This game plays itself, mostly. You start off with a party size of 1, and can recruit more members as you go. Make your first unit, and start afking today!</p>
					<p class="small red-text text-darken-2">Note: This game plays itself, but only while you keep the page open. You can open another tab to browse the forum. If you are already playing the game, and try to play it again, you will get rejected.</p>
					<br />
					<div class="row">
						<div class="col s2"> <h5>Name: </h5> </div>
						<div class="col s10">
							<input type="text" id="unitName" name="unitName" placeholder="Enter Name Here" value="{{generateName}}" />
						</div>

						<div class="col s2"> <h5>Job: </h5> </div>
						<div class="col s10">
							<input type="text" id="unitJob" name="unitJob" placeholder="Enter Job Here" value="Mercenary"/>
						</div>
						<input class="button green darken-4 white-text" type="submit" id="newGame" value="SOLD!"/>
						<div id="pmerror" class="col s12"></div>
					</div>
					
				</div>
			</div>
			{{/if}}
			
			{{else}}
			<div class="title center">You must be logged in.</div>
			{{/if}}
			
		</div>
	</div>
	
</template>